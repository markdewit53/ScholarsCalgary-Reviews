<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scholars Review</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 40px 20px;
      background-color: #f9f9f9;
      color: #333;
    }
    .logo {
      width: 250px;
      margin-bottom: 30px;
    }
    .message {
      font-size: 1.3em;
      margin: 30px 0 15px;
    }
    .btn {
      display: inline-block;
      padding: 12px 24px;
      font-size: 1.1em;
      font-weight: bold;
      border-radius: 6px;
      color: white;
      text-decoration: none;
      margin: 10px;
      transition: all 0.3s;
    }
    .review-btn {
      background-color: #01549C;
    }
    .review-btn:hover {
      background-color: #013F70;
      transform: translateY(-2px);
    }
    .feedback-btn {
      background-color: #E71F2E;
    }
    .feedback-btn:hover {
      background-color: #B01724;
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <!-- Dynamic content will be inserted here -->
  <div id="content">
    <div class="spinner"></div>
  </div>

  <script>
    // Configuration
    const config = {
      reviewUrls: {
        ML: 'https://g.page/r/CUo-0tq7WzhQEBM/review',
        CW: 'https://g.page/r/CUWPceUi9tjXEBM/review'
      },
      feedbackUrl: 'https://forms.gle/7M9bViSeiCjKa3WcA',
      gasTrackingUrl: 'https://script.google.com/macros/s/AKfycbxjbkY4VTbq4xzNLY5alfz3z_kuDZ-6HDKOZL13llQyp6bpArN57VO7COCzN611qORU/exec'
    };

    // Extract ML/CW and ID from URL
    const pathParts = window.location.pathname.split('/').filter(Boolean);
    const type = pathParts[0]; // 'ML' or 'CW'
    const userId = pathParts[1]; // 'annalisa', 'marky', etc.

    // Show appropriate landing page
    function showLandingPage() {
      const content = `
        <img class="logo" src="https://i.imgur.com/AKwAdog.jpeg" alt="Scholars Logo">
        <p class="message">${type === 'ML' 
          ? "Thank you for choosing Scholars!" 
          : "We appreciate your feedback!"}</p>
        <a href="${config.reviewUrls[type]}" class="btn review-btn" id="reviewBtn">
          Leave a Review
        </a>
        <a href="${config.feedbackUrl}" class="btn feedback-btn">
          Share Feedback
        </a>
      `;
      document.getElementById('content').innerHTML = content;
      
      // Track the pageview
      trackInteraction('pageview');
      
      // Track review button clicks
      document.getElementById('reviewBtn')?.addEventListener('click', () => {
        trackInteraction('review_click');
      });
    }

    // Send tracking data to GAS
    function trackInteraction(action) {
      const data = {
        type: type,
        id: userId,
        action: action,
        timestamp: new Date().toISOString()
      };
      
      fetch(`${config.gasTrackingUrl}?data=${encodeURIComponent(JSON.stringify(data))}`, {
        mode: 'no-cors',
        cache: 'no-store'
      }).catch(e => console.log('Tracking sent'));
    }

    // Initialize
    if (['ML', 'CW'].includes(type) && userId) {
      showLandingPage();
    } else {
      document.getElementById('content').innerHTML = `
        <p>Invalid link. Please check the URL and try again.</p>
      `;
    }
  </script>
</body>
</html>
